# Documentation

This directory contains automatically generated project documentation.

## Database

### Entity Relationship Diagram

The ER diagram below represents the database schema with all tables, relationships, and constraints.

```mermaid
erDiagram

    ingredients {
        id varchar(255) PK
        name varchar(255) UK
        package_quantity numeric(10_3)
        package_price numeric(10_2)
        created_at timestamp_without_time_zone
        updated_at timestamp_without_time_zone
        package_unit measurement_unit
    }

    recipe_ingredients {
        id integer PK
        recipe_id varchar(255) FK
        ingredient_id varchar(255) FK
        quantity numeric(10_3)
        created_at timestamp_without_time_zone
        unit measurement_unit
    }

    recipes {
        id varchar(255) PK
        name varchar(255) UK
        created_at timestamp_without_time_zone
        updated_at timestamp_without_time_zone
        total_cost numeric(10_2)
    }

    ingredients ||--o{ recipe_ingredients : "has"
    recipes ||--o{ recipe_ingredients : "has"
```

### How It Works

The ER diagram is automatically generated by GitHub Actions on every commit to `main` that modifies database migration files.

**Workflow:**
1. Trigger on push to `main` with changes in `src/main/resources/db/migration/**`
2. PostgreSQL container is started and Flyway migrations are executed
3. ER diagram is generated from database metadata and embedded in README
4. Documentation is committed back to the repository with `[skip ci]`

**Manual Generation:**

```bash
# Ensure PostgreSQL is running
docker-compose up -d postgres

# Generate ER diagram (automatically updates README)
PGHOST=localhost PGPORT=5432 PGDATABASE=costify PGUSER=postgres PGPASSWORD=postgres \
  ./scripts/generate-er-diagram.sh
```

### Viewing the Diagram

- **GitHub**: The Mermaid diagram renders natively in GitHub's markdown viewer
- **VS Code**: Install "Markdown Preview Mermaid Support" extension
- **Other editors**: Any Mermaid-compatible markdown viewer

---

*This documentation is automatically updated by the CI/CD pipeline.*
